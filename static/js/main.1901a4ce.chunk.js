(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{15:function(e,t,r){e.exports={form:"ProfileForm_form__nH_qX",error:"ProfileForm_error__2iRa5",changed:"ProfileForm_changed__39Hz7",control:"ProfileForm_control__2M6Wf",action:"ProfileForm_action__28kbp"}},22:function(e,t,r){e.exports={header:"MainNavigation_header__1I2cR",logo:"MainNavigation_logo__3zZe7"}},25:function(e,t,r){e.exports={profile:"UserProfile_profile__3KFH3"}},26:function(e,t,r){e.exports={starting:"StartingPageContent_starting__iWUVG"}},35:function(e,t,r){},37:function(e,t,r){"use strict";r.r(t);var n,s,a,o=r(24),i=r.n(o),c=(r(35),r(0)),l=r.n(c),u=r(3),j=r(7),d=r(5),g=r(1),m=l.a.createContext({token:"",isLoggedIn:!1,login:function(e){},logout:function(){},passError:"",emailError:"",authErrorsHandler:function(e){},passChanging:{},changePasswordHandler:function(e){},clearErrors:function(){}}),p=function(e){var t=(new Date).getTime();return new Date(e).getTime()-t},b=function(e){var t,r=function(){var e=localStorage.getItem("token"),t=localStorage.getItem("expirationTime"),r=p(t);return r<=0?(localStorage.removeItem("token"),localStorage.removeItem("expirationTime"),null):{token:e,duration:r}}();r&&(t=r.token);var s=Object(c.useState)(t),a=Object(d.a)(s,2),o=a[0],i=a[1],l=Object(c.useState)(""),u=Object(d.a)(l,2),j=u[0],b=u[1],h=Object(c.useState)(""),O=Object(d.a)(h,2),x=O[0],f=O[1],v=Object(c.useState)({isError:!1,message:""}),k=Object(d.a)(v,2),w=k[0],_=k[1],T=!!o,S=function(){f(""),b(""),_({isError:!1,message:""})},E=Object(c.useCallback)((function(){i(null),localStorage.removeItem("token"),localStorage.removeItem("expirationTime"),_({isError:!1,message:"Changed Successfully"}),n&&clearTimeout(n)}),[]);Object(c.useEffect)((function(){r&&(n=setTimeout(E,r.duration))}),[r,E]);var C={token:o,isLoggedIn:T,login:function(e,t){i(e),localStorage.setItem("token",e),localStorage.setItem("expirationTime",t);var r=p(t);n=setTimeout(E,r),S()},logout:E,passError:j,emailError:x,authErrorsHandler:function(e){e.includes("PASSWORD")?(b(e.replaceAll("_"," ")),f("")):e.includes("EMAIL")&&(f(e.replaceAll("_"," ")),b(""))},passChanging:w,changePasswordHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(i(e.idToken),localStorage.setItem("token",e.idToken),localStorage.setItem("expirationTime",e.expirationTime),_({isError:!1,message:"Changed Successfully"})):_({isError:!0,message:e.replaceAll("_"," ")})},clearErrors:S};return Object(g.jsx)(m.Provider,{value:C,children:e.children})},h=m,O=r(22),x=r.n(O),f=function(){var e=Object(u.o)(),t=Object(c.useContext)(h),r=t.isLoggedIn;return Object(g.jsxs)("header",{className:x.a.header,children:[Object(g.jsx)(j.b,{to:"/",children:Object(g.jsx)("div",{className:x.a.logo,children:"React Auth"})}),Object(g.jsx)("nav",{children:Object(g.jsxs)("ul",{children:[!r&&Object(g.jsx)("li",{children:Object(g.jsx)(j.b,{to:"/login",children:"Login"})}),r&&Object(g.jsx)("li",{children:Object(g.jsx)(j.b,{to:"/profile",children:"Profile"})}),r&&Object(g.jsx)("li",{children:Object(g.jsx)("button",{onClick:function(){t.logout(),e("/Home",{replace:!0})},children:"Logout"})})]})})]})},v=function(){return Object(g.jsxs)(c.Fragment,{children:[Object(g.jsx)(f,{}),Object(g.jsx)("main",{children:Object(g.jsx)(u.b,{})})]})},k=r(4),w=r(6),_=r(15),T=r.n(_),S=function(e){var t=e.changingPass,r=Object(c.useContext)(h);return Object(g.jsxs)(j.a,{className:T.a.form,method:"POST",action:"/profile",children:[Object(g.jsxs)("div",{className:T.a.control,children:[Object(g.jsx)("label",{htmlFor:"new-password",children:"New Password"}),Object(g.jsx)("input",{type:"password",id:"new-password",name:"password"}),r.passChanging.isError&&Object(g.jsx)("p",{className:T.a.error,children:r.passChanging.message}),!r.passChanging.isError&&r.passChanging.message&&Object(g.jsx)("p",{className:T.a.changed,children:r.passChanging.message})]}),Object(g.jsxs)("div",{className:T.a.action,children:[!t&&Object(g.jsx)("button",{children:"Change Password"}),t&&Object(g.jsx)("p",{children:"Changing password..."})]})]})},E=r(25),C=r.n(E),y=function(e){return Object(g.jsxs)("section",{className:C.a.profile,children:[Object(g.jsx)("h1",{children:"Your User Profile"}),Object(g.jsx)(S,{passChanged:e.passChanged,changingPass:e.changingPass})]})},N=function(){var e=Object(c.useContext)(h),t=Object(u.j)(),r=Object(u.p)();return s=e.token,t&&!t.isError&&setTimeout((function(){var r=new Date((new Date).getTime()+1e3*+t.message.expiresIn);e.changePasswordHandler({idToken:t.message.idToken,expirationTime:r.toISOString()},!0),a=!0}),0),t&&t.isError&&setTimeout((function(){e.changePasswordHandler(t.message.error.errors[0].message),a=!1}),0),Object(g.jsx)(y,{passChanged:a,changingPass:"submitting"===r.state})};function P(e){return I.apply(this,arguments)}function I(){return(I=Object(w.a)(Object(k.a)().mark((function e(t){var r,n,a;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.request,e.next=3,r.formData();case 3:return n=e.sent,e.next=6,fetch("https://identitytoolkit.googleapis.com/v1/accounts:update?key=AIzaSyAZThACu5VNBs-7nmH9cnQQKAVvYSYaDms",{method:"POST",body:JSON.stringify({idToken:s,password:n.get("password"),returnSecureToken:!0}),headers:{"Content-Type":"application/json"}});case 6:if((a=e.sent).ok){e.next=12;break}return e.next=10,a.json();case 10:return e.t0=e.sent,e.abrupt("return",{isError:!0,message:e.t0});case 12:return e.next=14,a.json();case 14:return e.t1=e.sent,e.abrupt("return",{isError:!1,message:e.t1});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=r(8),L=r.n(A),F=function(e){var t=Object(c.useContext)(h);return Object(g.jsxs)("section",{className:L.a.auth,children:[Object(g.jsx)("h1",{children:"Log in"}),Object(g.jsxs)(j.a,{method:"POST",action:"/login","data-testid":"loginform",children:[Object(g.jsxs)("div",{className:L.a.control,children:[Object(g.jsx)("label",{htmlFor:"email",children:"Your Email"}),Object(g.jsx)("input",{type:"email",id:"email",required:!0,name:"email"}),t.emailError&&Object(g.jsx)("p",{className:L.a.error,children:t.emailError})]}),Object(g.jsxs)("div",{className:L.a.control,children:[Object(g.jsx)("label",{htmlFor:"password",children:"Your Password"}),Object(g.jsx)("input",{type:"password",id:"password",required:!0,name:"password"}),t.passError&&Object(g.jsx)("p",{className:L.a.error,children:t.passError})]}),Object(g.jsxs)("div",{className:L.a.actions,children:[!e.isLoading&&Object(g.jsx)("button",{children:"Log in"}),e.isLoading&&Object(g.jsx)("p",{children:"Logging in..."}),Object(g.jsx)(j.b,{className:L.a.toggle,to:"/signup",onClick:function(){t.clearErrors()},children:"Create New Account"})]})]})]})},H=function(){var e=Object(u.p)(),t=Object(u.o)(),r=Object(c.useContext)(h),n=Object(u.j)();return n&&!n.isError&&n.idToken&&setTimeout((function(){r.login(n.idToken,n.expirationTime.toISOString()),t("/profile")}),0),n&&n.isError&&setTimeout((function(){r.authErrorsHandler(n.message.error.errors[0].message)}),0),Object(g.jsx)(F,{isLoading:"submitting"===e.state})};function D(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(w.a)(Object(k.a)().mark((function e(t){var r,n,s,a,o;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.request,e.next=3,r.formData();case 3:return n=e.sent,e.next=6,fetch("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAZThACu5VNBs-7nmH9cnQQKAVvYSYaDms",{method:"POST",body:JSON.stringify({email:n.get("email"),password:n.get("password"),returnSecureToken:!0}),headers:{"Content-Type":"application/json"}});case 6:if((s=e.sent).ok){e.next=12;break}return e.next=10,s.json();case 10:return e.t0=e.sent,e.abrupt("return",{isError:!0,message:e.t0});case 12:return e.next=14,s.json();case 14:return a=e.sent,o=new Date((new Date).getTime()+1e3*+a.expiresIn),e.abrupt("return",{isError:!1,expirationTime:o,idToken:a.idToken});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=function(e){var t=Object(c.useContext)(h),r=function(){t.clearErrors()};return Object(g.jsxs)("section",{className:L.a.auth,children:[Object(g.jsx)("h1",{children:"Sign Up"}),Object(g.jsxs)(j.a,{method:"POST",action:"/signup",children:[Object(g.jsxs)("div",{className:L.a.control,children:[Object(g.jsx)("label",{htmlFor:"email",children:"Your Email"}),Object(g.jsx)("input",{type:"email",id:"email",required:!0,name:"email"}),t.emailError&&Object(g.jsx)("p",{className:L.a.error,children:t.emailError})]}),Object(g.jsxs)("div",{className:L.a.control,children:[Object(g.jsx)("label",{htmlFor:"password",children:"Your Password"}),Object(g.jsx)("input",{type:"password",id:"password",required:!0,name:"password"}),t.passError&&Object(g.jsx)("p",{className:L.a.error,children:t.passError})]}),Object(g.jsxs)("div",{className:L.a.actions,children:[!e.isLoading&&Object(g.jsx)("button",{onClick:r,children:"Create Account"}),e.isLoading&&Object(g.jsx)("p",{children:"Signing Up..."}),Object(g.jsx)(j.b,{className:L.a.toggle,to:"/login",onClick:r,children:"Login with existing account"})]})]})]})},V=r(2),Q=function(){var e=Object(u.p)(),t=Object(c.useContext)(h),r=Object(u.j)();return r&&r.isError&&setTimeout((function(){t.authErrorsHandler(r.message.error.errors[0].message)}),0),Object(g.jsx)(q,{isLoading:"submitting"===e.state})};function R(e){return U.apply(this,arguments)}function U(){return(U=Object(w.a)(Object(k.a)().mark((function e(t){var r,n,s,a;return Object(k.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.request,e.next=3,r.formData();case 3:return n=e.sent,e.next=6,fetch("https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAZThACu5VNBs-7nmH9cnQQKAVvYSYaDms",{method:"POST",body:JSON.stringify({email:n.get("email"),password:n.get("password"),returnSecureToken:!0}),headers:{"Content-Type":"application/json"}});case 6:if((s=e.sent).ok){e.next=12;break}return e.next=10,s.json();case 10:return a=e.sent,e.abrupt("return",{isError:!0,message:a});case 12:return e.abrupt("return",Object(V.n)("/login"));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=r(26),B=r.n(z),J=function(){return Object(g.jsxs)("section",{className:B.a.starting,children:[Object(g.jsx)("h1",{children:"Welcome on Board!"}),Object(g.jsx)("h2",{children:"please log in to see your profile"})]})},W=function(){return Object(g.jsx)(J,{})};var K=function(){var e=Object(c.useContext)(h);return Object(g.jsx)(u.d,{router:Object(j.c)([{element:Object(g.jsx)(v,{}),children:[{path:"/",element:Object(g.jsx)(u.a,{replace:!0,to:"/Home"})},{path:"/Home",element:e.isLoggedIn?Object(g.jsx)(u.a,{replace:!0,to:"/profile"}):Object(g.jsx)(W,{})},{path:"/login",element:e.isLoggedIn?Object(g.jsx)(u.a,{replace:!0,to:"/profile"}):Object(g.jsx)(H,{}),action:D},{path:"/signup",element:e.isLoggedIn?Object(g.jsx)(u.a,{replace:!0,to:"/profile"}):Object(g.jsx)(Q,{}),action:R},{path:"/profile",element:e.isLoggedIn?Object(g.jsx)(N,{}):Object(g.jsx)(u.a,{replace:!0,to:"/"}),action:P},{path:"*",element:Object(g.jsx)(u.a,{replace:!0,to:"/"})}]}])})};i.a.createRoot(document.getElementById("root")).render(Object(g.jsx)(b,{children:Object(g.jsx)(K,{})}))},8:function(e,t,r){e.exports={auth:"AuthForm_auth__11Aky",error:"AuthForm_error__2olA8",control:"AuthForm_control__28m2k",actions:"AuthForm_actions__29RnI",toggle:"AuthForm_toggle__2GVfb"}}},[[37,1,2]]]);
//# sourceMappingURL=main.1901a4ce.chunk.js.map